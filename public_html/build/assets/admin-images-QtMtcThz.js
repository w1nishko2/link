function u(t="image-input"){const n=document.getElementById(t);n?n.click():console.warn("File input not found with ID:",t)}function f(t,n="image-preview-container",e=null){const i=t.target.files[0];if(!i)return;if(!i.type.startsWith("image/")){alert("Пожалуйста, выберите файл изображения"),t.target.value="";return}const o=10*1024*1024;if(i.size>o){alert("Размер файла не должен превышать 10MB"),t.target.value="";return}h(n),p(i,n,e)}function p(t,n,e=null){const i=new FileReader;i.onload=function(o){const a=new Image;a.onload=function(){const r=document.createElement("canvas"),l=r.getContext("2d"),d=800,g=600;let{width:s,height:c}=y(this.width,this.height,d,g);r.width=s,r.height=c,l.drawImage(this,0,0,s,c);const m=r.toDataURL("image/jpeg",.85);w(n,m),e&&typeof e=="function"&&e(t,m)},a.src=o.target.result},i.readAsDataURL(t)}function y(t,n,e,i){if(t<=e&&n<=i)return{width:t,height:n};const o=Math.min(e/t,i/n);return{width:Math.round(t*o),height:Math.round(n*o)}}function h(t){const n=document.getElementById(t);if(n){const e=document.createElement("div");e.className="image-loading",e.style.cssText=`
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
        `,e.innerHTML=`
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Загрузка...</span>
            </div>
        `,n.appendChild(e)}}function w(t,n){const e=document.getElementById(t);if(!e)return;const i=e.querySelector(".image-loading");i&&i.remove();const o=e.querySelector("img");if(o)o.src=n;else{const r=document.createElement("img");r.src=n,r.style.width="100%",r.style.height="100%",r.style.objectFit="cover",r.style.borderRadius="12px",e.appendChild(r)}const a=e.querySelector(".no-image, .image-no-image");a&&(a.style.display="none")}function v(t,n){const e=document.getElementById(n);if(!e){console.warn("Preview container not found with ID:",n);return}const i=e.querySelector("img");if(i)i.src=t;else{const a=document.createElement("img");a.src=t,a.style.width="100%",a.style.height="100%",a.style.objectFit="cover",a.style.borderRadius="12px",e.appendChild(a)}const o=e.querySelector(".no-image, .image-no-image");o&&(o.style.display="none")}function I(t,n="image-input"){const e=document.getElementById(t),i=document.getElementById(n);if(e){const o=e.querySelector("img");o&&o.remove();const a=e.querySelector(".no-image, .image-no-image");a&&(a.style.display="flex")}i&&(i.value="")}function x(t,n={}){const{maxSize:e=10*1024*1024,allowedTypes:i=["image/jpeg","image/png","image/gif","image/webp"],minWidth:o=0,minHeight:a=0,maxWidth:r=1/0,maxHeight:l=1/0}=n;return i.includes(t.type)?t.size>e?(alert(`Размер файла не должен превышать ${Math.round(e/1024/1024)}MB`),!1):!0:(alert("Допустимые форматы: "+i.join(", ")),!1)}window.triggerFileInput=u;window.handleImageSelect=f;window.createImagePreview=v;window.removeImage=I;window.validateImage=x;
